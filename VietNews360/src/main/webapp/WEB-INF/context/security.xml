<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
            http://www.springframework.org/schema/security
            http://www.springframework.org/schema/security/spring-security-3.2.xsd">
            
    <http auto-config="false" use-expressions="true" disable-url-rewriting="true">
    <!--Cấu hình không sử dụng cấu hình tự động, sử dụng biểu thức để đánh giá quy tắc bảo mật và vô hiệu hóa việc tự động tái viết URL.
    auto-config: Vô hiệu hóa cấu hình tự động
    use-expressions="true": Cho phép sd biểu thức để đánh gia quy tắc bảo mật
    disabale-ủl-rewriting="true": Vô hiệu hóa việc tái thiết URL 
    -->
    	<intercept-url pattern="/quan-tri/trang-chu" access="hasAnyRole('ADMIN')" />
    <!--Xd quy tắc bảo mật cho url "/quan-tri/trang-chu" yêu cầu ng dùng có vai trò `ADMIN`"-->	
    	<access-denied-handler error-page="/accessDenied" />
        <!--Cấu hình trang lỗi khi truy cập bị từ chối-->
        <!---->
        <!--Cấu hình xác thực dựa trên form đăng nhập
        1.login-page="/dang-nhap": Đường dẫn đến trang đăng nhập
        2.username-parameter="j_username": tham số trường tên ng dùng
        3.password-parameter="j_paaword": tham số trường mật khẩu
        4.authentication-ssucces-handler-ref+"customSuccessHandlerRef":tham
        chiết đến một đối tượng khi xác thực thành công 
        5. authentication-failure-url="/dang-nhap?incorrectAccount": Đường dẫn khi đăng
        nhập thất bại
        -->
        <form-login  login-page="/dang-nhap"
                     username-parameter="j_username"
                     password-parameter="j_password"
                     login-processing-url="/j_spring_security_check"
                     authentication-success-handler-ref="customSuccessHandler"
                     authentication-failure-url="/dang-nhap?incorrectAccount"/>
        <!--Cấu hình quản lý phiên và xác định phiên ỦRL khi phiên hợp lệ
        người dùng sẽ được chuyển hướng đến "/dang-nhap?sessionTimeout"
        -->             
        <session-management invalid-session-url="/dang-nhap?sessionTimeout"/>
        <!--Cấu hình đăng xuất và xóa cookies="JSESSIONID"
        
        -->
        <logout delete-cookies="JSESSIONID"/>
    </http>
    <!--là 1 thành phần quan trọng trong cấu hình spring Security , nơi xđ cung cấp
    các xác thực và quản lý đối tượng `Authortication`
    authentication-manager: phần bắt đầu của cấu hình
    -nơi bạn xác định các chi tiết về quản lý xác thực người dùng.
    1.<authentication-provider> : là một phần tử con <authentication-manager> , xác định cách thức
    xác thức người dùng và các thông tin liên quan
    2.user-service-ref : là một thuộc tính của <authotication-provider>  chỉ định tên bean xử lý
    đươc sd để xác thực thông tin người dùng 
    3.<password-encoder> : một phần tử con của <authortication-provider> xác định mã hóa mật khẩu
    người dùng . trong đoạn code giá trị `bcryptEncoder` để cập đến bean được định nghĩa trong spring ,
    đại diện cho một mã hóa mk cụ thể
    Tóm lại L `customUserDetailsService` để lấy thông tin ng dùng và bcryptEnCoder để mã hóa mât khẩu ng
    dùng. Tùy chỉnh cấu hình này cho phép xác định nguồn dữ liệu và phương pháp mã hóa mk
     -->
    <authentication-manager >
        <authentication-provider user-service-ref="customUserDetailsService">
        		<password-encoder ref="bcryptEncoder"/>
        </authentication-provider>
    </authentication-manager>
    
    <beans:bean id="bcryptEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder" />
    <beans:bean id="customUserDetailsService" class="com.vietnew360.service.impl.CustomUserDetailsService" />
    <beans:bean id="customSuccessHandler" class="com.vietnew360.security.CustomSuccessHandler" />
    
</beans:beans>